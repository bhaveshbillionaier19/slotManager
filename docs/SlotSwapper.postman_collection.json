{
  "info": {
    "name": "SlotSwapper API",
    "description": "Complete API collection for SlotSwapper - Meeting Slot Management System",
    "version": "1.0.0",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json"
  },
  "auth": {
    "type": "bearer",
    "bearer": [
      {
        "key": "token",
        "value": "{{access_token}}",
        "type": "string"
      }
    ]
  },
  "variable": [
    {
      "key": "base_url",
      "value": "http://localhost:8000",
      "type": "string"
    },
    {
      "key": "access_token",
      "value": "",
      "type": "string"
    },
    {
      "key": "user_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "event_id",
      "value": "",
      "type": "string"
    },
    {
      "key": "swap_request_id",
      "value": "",
      "type": "string"
    }
  ],
  "item": [
    {
      "name": "Authentication",
      "item": [
        {
          "name": "Register User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('access_token', response.access_token);",
                  "    pm.environment.set('user_id', response.user.id);",
                  "    pm.test('Registration successful', function () {",
                  "        pm.expect(response.access_token).to.be.a('string');",
                  "        pm.expect(response.user.email).to.be.a('string');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john.doe@example.com\",\n  \"name\": \"John Doe\",\n  \"password\": \"securepassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/register",
              "host": ["{{base_url}}"],
              "path": ["auth", "register"]
            },
            "description": "Register a new user account"
          }
        },
        {
          "name": "Login User",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 200) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('access_token', response.access_token);",
                  "    pm.test('Login successful', function () {",
                  "        pm.expect(response.access_token).to.be.a('string');",
                  "        pm.expect(response.token_type).to.equal('bearer');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"email\": \"john.doe@example.com\",\n  \"password\": \"securepassword123\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/auth/login",
              "host": ["{{base_url}}"],
              "path": ["auth", "login"]
            },
            "description": "Login with existing user credentials"
          }
        },
        {
          "name": "Get Current User",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/auth/me",
              "host": ["{{base_url}}"],
              "path": ["auth", "me"]
            },
            "description": "Get current authenticated user information"
          }
        }
      ],
      "description": "Authentication endpoints for user registration and login"
    },
    {
      "name": "Events",
      "item": [
        {
          "name": "Create Event",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('event_id', response.id);",
                  "    pm.test('Event created successfully', function () {",
                  "        pm.expect(response.id).to.be.a('string');",
                  "        pm.expect(response.title).to.be.a('string');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Team Meeting\",\n  \"description\": \"Weekly team sync meeting\",\n  \"start_time\": \"2024-12-01T10:00:00\",\n  \"end_time\": \"2024-12-01T11:00:00\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/events/",
              "host": ["{{base_url}}"],
              "path": ["events", ""]
            },
            "description": "Create a new meeting event"
          }
        },
        {
          "name": "List User Events",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/events/",
              "host": ["{{base_url}}"],
              "path": ["events", ""]
            },
            "description": "Get all events for the authenticated user"
          }
        },
        {
          "name": "Get Event by ID",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/events/{{event_id}}",
              "host": ["{{base_url}}"],
              "path": ["events", "{{event_id}}"]
            },
            "description": "Get a specific event by ID"
          }
        },
        {
          "name": "Update Event",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"title\": \"Updated Team Meeting\",\n  \"description\": \"Updated description\",\n  \"status\": \"SWAPPABLE\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/events/{{event_id}}",
              "host": ["{{base_url}}"],
              "path": ["events", "{{event_id}}"]
            },
            "description": "Update an existing event"
          }
        },
        {
          "name": "Delete Event",
          "request": {
            "method": "DELETE",
            "header": [],
            "url": {
              "raw": "{{base_url}}/events/{{event_id}}",
              "host": ["{{base_url}}"],
              "path": ["events", "{{event_id}}"]
            },
            "description": "Delete an event"
          }
        }
      ],
      "description": "Event management endpoints"
    },
    {
      "name": "Swap Requests",
      "item": [
        {
          "name": "Get Swappable Events",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/swaps/swappable-events",
              "host": ["{{base_url}}"],
              "path": ["swaps", "swappable-events"]
            },
            "description": "Get all events available for swapping (excluding user's own events)"
          }
        },
        {
          "name": "Create Swap Request",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "if (pm.response.code === 201) {",
                  "    const response = pm.response.json();",
                  "    pm.environment.set('swap_request_id', response.id);",
                  "    pm.test('Swap request created successfully', function () {",
                  "        pm.expect(response.id).to.be.a('string');",
                  "        pm.expect(response.status).to.equal('PENDING');",
                  "    });",
                  "}"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"offered_event_id\": \"{{event_id}}\",\n  \"requested_event_id\": \"target-event-id-here\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/swaps/request",
              "host": ["{{base_url}}"],
              "path": ["swaps", "request"]
            },
            "description": "Create a new swap request"
          }
        },
        {
          "name": "Get Incoming Requests",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/swaps/incoming-requests",
              "host": ["{{base_url}}"],
              "path": ["swaps", "incoming-requests"]
            },
            "description": "Get swap requests where user's events are being requested"
          }
        },
        {
          "name": "Get Outgoing Requests",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/swaps/outgoing-requests",
              "host": ["{{base_url}}"],
              "path": ["swaps", "outgoing-requests"]
            },
            "description": "Get swap requests created by the user"
          }
        },
        {
          "name": "Accept Swap Request",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"response\": \"ACCEPTED\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/swaps/{{swap_request_id}}/respond",
              "host": ["{{base_url}}"],
              "path": ["swaps", "{{swap_request_id}}", "respond"]
            },
            "description": "Accept a swap request"
          }
        },
        {
          "name": "Decline Swap Request",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"response\": \"DECLINED\"\n}"
            },
            "url": {
              "raw": "{{base_url}}/swaps/{{swap_request_id}}/respond",
              "host": ["{{base_url}}"],
              "path": ["swaps", "{{swap_request_id}}", "respond"]
            },
            "description": "Decline a swap request"
          }
        }
      ],
      "description": "Swap request management endpoints"
    },
    {
      "name": "System",
      "item": [
        {
          "name": "Health Check",
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/health",
              "host": ["{{base_url}}"],
              "path": ["health"]
            },
            "description": "Check API health status"
          }
        }
      ],
      "description": "System monitoring endpoints"
    }
  ],
  "event": [
    {
      "listen": "prerequest",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Auto-set authorization header if token exists",
          "const token = pm.environment.get('access_token');",
          "if (token && token !== '') {",
          "    pm.request.headers.add({",
          "        key: 'Authorization',",
          "        value: 'Bearer ' + token",
          "    });",
          "}"
        ]
      }
    },
    {
      "listen": "test",
      "script": {
        "type": "text/javascript",
        "exec": [
          "// Global test to check response time",
          "pm.test('Response time is less than 2000ms', function () {",
          "    pm.expect(pm.response.responseTime).to.be.below(2000);",
          "});",
          "",
          "// Global test to check for common error responses",
          "if (pm.response.code >= 400) {",
          "    pm.test('Error response has detail field', function () {",
          "        const response = pm.response.json();",
          "        pm.expect(response).to.have.property('detail');",
          "    });",
          "}"
        ]
      }
    }
  ]
}
